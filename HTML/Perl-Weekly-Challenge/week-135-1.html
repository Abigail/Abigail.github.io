<html>
<head>
<title>Perl Weekly Challenge 135: Middle 3-digits</title>
<script src = "https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id = "MathJax-script" async src = "https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.js"></script>
<script src = '../../JavaScript/jquery.js'></script>
<script src = '../../JavaScript/navigation.js'></script>
<link rel = 'preconnect' href = 'https://fonts.gstatic.com'>
<link rel = 'stylesheet' href = 'https://fonts.googleapis.com/css2?family=Lobster+Two&family=Source+Code Pro&family=Pinyon+Script&family=Sorts+Mill Goudy:ital@1&display=swap'>
<link rel = 'stylesheet' href = '../../Styles/Perl-Weekly-Challenge/main.css'>
</head>

<body><h1>Perl Weekly Challenge 135: Middle 3-digits</h1><div class = "byline">
by Abigail<br>
<img src = "../../Images/jan_sluiters.jpg">
</div>


<h2><a href="https://theweeklychallenge.org/blog/perl-weekly-challenge-135/#TASK1">Challenge</a></h2>

<blockquote>
  <p>You are given an integer.</p>
  
  <p>Write a script find out the middle 3-digits of the given integer,
  if possible otherwise throw sensible error.</p>
</blockquote>

<h3>Example 1</h3>

<pre><code>Input: $n = 1234567
Output: 345
</code></pre>

<h3>Example 2</h3>

<pre><code>Input: $n = -123
Output: 123
</code></pre>

<h3>Example 3</h3>

<pre><code>Input: $n = 1
Output: too short
</code></pre>

<h3>Example 4</h3>

<pre><code>Input: $n = 10
Output: even number of digits
</code></pre>

<h2>Solution</h2>

<div class = "section">
<p>We need to do a couple of things, all fairly trivial:</p>

<ol>
<li>Read a line from standard input.</li>
<li>Remove a leading sign, as we can basically ignore it.</li>
<li>Check we're left with only digits; error if not.</li>
<li>Check we have an odd number of digits; error if not.</li>
<li>Check we have at least three digits; error if not.</li>
<li>Extract the middle three digits, and print them.</li>
</ol>

<p>The third step technically isn't required, as it's a given we're getting
an integer. But we check anyway.</p>

<p>Note that a two digit integer fails validation twice: it's too short,
and it has an even number of digits. The fourth example shows we should
give an error for the second failure (and not the first).</p>

<p>As usual, we will be accepting multiple integers, assuming one
integer per line of input. For each integer, we'll print the
middle three digits, or an error if necessary.</p>
</div>

<h3>AWK</h3>

<div class = "section">
<p>AWK is very suitable to repeatedly do something to a line of input,
and to repeat this for each line of input.</p>

<p>We start off with stripping a leading sign, if any:</p>

<pre><code>/^[-+]/         {$0 = substr ($0, 2)}
</code></pre>

<p><code>$0</code> holds the current line of input, and it's an lvalue, so we can
assign to it.</p>

<p>We can now do the validation. If it fails a validation, we print an
error message, and continue with the next line of input:</p>

<pre><code>/[^0-9]/        {print "not an integer";        next}
/^(..)*$/       {print "even number of digits"; next}
length ($0) &lt; 3 {print "too short";             next}
</code></pre>

<p>We can now print the middle three digits:</p>

<pre><code>{print substr ($0, 1 + (length ($0) - 3) / 2, 3)}
</code></pre>

<p><a href="https://www.gnu.org/software/gawk/manual/gawk.html#String-Functions"><code>substr</code></a> in AWK takes three arguments: the string we want to
extract a substring from; the position from where to start (first
character is on position 1), and the length of the substring.</p>

<p>Find the <a href="https://github.com/Abigail/perlweeklychallenge-club/blob/master/challenge-135/abigail/awk/ch-1.awk">full program</a> on <a href="https://github.com">GitHub</a>.</p>
</div>

<h3>Bash</h3>

<div class = "section">
<p>We first start off reading a line of input using <a href="https://www.gnu.org/software/bash/manual/bash.html#Bash-Builtins"><code>read</code></a>:</p>

<pre><code>while read line; do
</code></pre>

<p>First, we strip off a leading sign, if any, using
<a href="https://www.gnu.org/software/bash/manual/bash.html#Shell-Parameter-Expansion">parameter expansion</a>:</p>

<pre><code>line=${line/#[-+]/}
</code></pre>

<p>This takes what is in the variable <code>line</code>, and performs a substitution:
replacing <code>#[-+]</code> with nothing (because there is nothing following
the second slash. Where most languages use <code>^</code> to indicate the
beginning of a string, here, this role is played by <code>#</code>.</p>

<p>We now check whether we are left with just digits:</p>

<pre><code>if [[ $line =~ [^0-9] ]]
then echo "not an integer"
</code></pre>

<p><a href="https://www.gnu.org/software/bash/manual/bash.html#Bash-Conditional-Expressions"><code>[[</code></a> introduces <em>Bash Conditional
Expressions</em>. The expression results in a true/false result. Here,
we are matching <code>line</code> against a regular expression. Note that we
don't need a delimiter here.</p>

<p>Checking for the right amount of digits:</p>

<pre><code>elif ((${#line} % 2 == 0))
then echo "even number of digits"
elif ((${#line} &lt; 3))
then echo "too short"
</code></pre>

<p><a href="https://www.gnu.org/software/bash/manual/bash.html#Shell-Arithmetic"><code>((</code></a> introduces <em>Shell Arithmetic</em>.</p>

<p>If we have passed all validations, we can print the right substring:</p>

<pre><code>echo ${line:$(((${#line} - 3) / 2)):3}
</code></pre>

<p>We do this with several other
<a href="https://www.gnu.org/software/bash/manual/bash.html#Shell-Parameter-Expansion">parameter expansions</a>.</p>

<p><code>${#line}</code> is the first parameter expansion. The result is the length
of the string in <code>line</code>.</p>

<p><code>$(((${#line} - 3) / 2))</code> takes what is inside <code>$(( ))</code> and treats
it as an arithmetic expression. The result is the start index of
substring we want.</p>

<p>We use another type of parameter expansion to get the substring:
<code>${line:position:length}</code> gets <code>length</code> characters from <code>line</code>,
starting at position <code>position</code>.</p>

<p>Find the <a href="https://github.com/Abigail/perlweeklychallenge-club/blob/master/challenge-135/abigail/bash/ch-1.sh">full program</a> on <a href="https://github.com">GitHub</a>.</p>
</div>

<h3>C</h3>

<div class = "section">
<p>We start off with reading a line from standard input. <a href="https://www.freebsd.org/cgi/man.cgi?apropos=0&amp;sektion=0&amp;query=getline"><code>getline</code></a>
will do the job:</p>

<pre><code>char *  line    = NULL;
size_t  len     = 0;
size_t  str_len;
while ((str_len = getline (&amp;line, &amp;len, stdin)) != -1) {
</code></pre>

<p>The string (with terminating newline) will be put into the character
array <code>line</code>, while the return value of <code>getline</code> is the length
of the line. (<code>getline</code> will do the <a href="https://www.freebsd.org/cgi/man.cgi?apropos=0&amp;sektion=0&amp;query=malloc"><code>malloc</code></a>ing for us, and
populate <code>len</code> with the number of bytes allocated; we will not
use <code>len</code> in our program).</p>

<p>We start with removing a leading sign, if any (if there is any
space following the sign, we will remove this as well):</p>

<pre><code>char * line_ptr = line;
if (* line_ptr == '-' || * line_ptr == '+') {
    str_len --;
    line_ptr ++;
    while (isspace (* line_ptr)) {
        line_ptr ++;
        str_len --;
    }
}
</code></pre>

<p>The result is that afterwards, <code>line_ptr</code> will point to the first
character following the sign. </p>

<p>Next step is to make sure all the other characters are digits.
Note that our string still contains a newline:</p>

<pre><code>bool done = false;
char * line_ptr2 = line_ptr;
while (* line_ptr2 &amp;&amp; * line_ptr2 != '\n') {
    if (!isdigit (* line_ptr2)) {
        printf ("not an integer\n");
        done = true;
        break;
    }
    line_ptr2 ++;
}
if (done) {
    continue;
}
</code></pre>

<p>C cannot break out of nested loops, so we determine the input
contains a non-digit, we set a boolean, and do the 
<code>continue</code> after we're done with the inner loop.</p>

<p>We can now check we have the right amount of digits (while
remembering we have a trailing newline):</p>

<pre><code>if (str_len % 2 == 1) {
    printf ("even number of digits\n");
    continue;
}

if (str_len &lt; 4) {
    printf ("too short\n");
    continue;
}
</code></pre>

<p>We can print the middle three digits, which we print one by one,
followed by a newline:</p>

<pre><code>size_t mid = (str_len - 3) / 2;
for (size_t i = 0; i &lt; 3; i ++) {
    printf ("%c", line_ptr [mid + i]);
}
printf ("\n");
</code></pre>

<p>It's C, so, we shouldn't forget the <a href="https://www.freebsd.org/cgi/man.cgi?apropos=0&amp;sektion=0&amp;query=free"><code>free</code></a> allocated
memory:</p>

<pre><code>free (line);
</code></pre>

<p>Find the <a href="https://github.com/Abigail/perlweeklychallenge-club/blob/master/challenge-135/abigail/c/ch-1.c">full program</a> on <a href="https://github.com">GitHub</a>.</p>
</div>

<h3>Go</h3>

<div class = "section">
<p>First, we have to read a line from standard input:</p>

<pre><code>    var reader = bufio . NewReader (os. Stdin)
main_loop:
    for {
        var text, err = reader . ReadString ('\n')
        if (err != nil) {
            break
        }
</code></pre>

<p>Stripping off the newline we do with <a href="https://pkg.go.dev/strings#TrimRight"><code>TrimRight</code></a> in the <code>string</code>
module:</p>

<pre><code>text = strings . TrimRight (text, "\n")
</code></pre>

<p>Go has immutable strings, so we have a leading sign, we take a
<a href="https://go.dev/blog/slices-intro"><em>slice</em></a>
from the string, and assign that back to the string:</p>

<pre><code>if (text [0:1] == "-" || text [0:1] == "+") {
    text = text [1:]
}
</code></pre>

<p>We now check whether the string contains just digits. For that,
we iterate over the <a href="https://go.dev/blog/strings"><em>runes</em></a> of the string:</p>

<pre><code>for _, rune := range text {
    if rune &lt; '0' || rune &gt; '9' {
        fmt . Print ("not an integer\n")
        continue main_loop
    }
}
</code></pre>

<p>We can now check for the correct number of digits. 
<a href="https://pkg.go.dev/builtin#len"><code>len</code></a> returns the length of a string:</p>

<pre><code>if len (text) % 2 == 0 {
    fmt . Print ("even number of digits\n")
    continue main_loop
}

if len (text) &lt; 3 {
    fmt . Print ("too short\n")
    continue main_loop
}
</code></pre>

<p>Now we can print the required digits, using a slice:</p>

<pre><code>fmt . Printf ("%s\n", text [(len (text) - 3) / 2 :
                            (len (text) + 3) / 2])
</code></pre>

<p>Find the <a href="https://github.com/Abigail/perlweeklychallenge-club/blob/master/challenge-135/abigail/go/ch-1.go">full program</a> on <a href="https://github.com">GitHub</a>.</p>
</div>

<h3>Java</h3>

<p>Java requires even more work to be done to just read a line of input:</p>

<pre><code>Scanner scanner = new Scanner (System . in);
try {
    while (true) {
        String line = scanner . nextLine ();
</code></pre>

<p>This time, we first check whether we have an integer, by using a regular
expression. The
<a href="https://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html#matches(java.lang.String,%20java.lang.CharSequence)"><code>matches</code></a>
function in the <code>Pattern</code> class
tries to match the given pattern against the given string:</p>

<pre><code>if (!Pattern . matches ("^[-+]?[0-9]+$", line)) {
    System . out . println ("not an integer");
    continue;
}
</code></pre>

<p>If the string starts with a sign, we get rid of it. Java strings
are immutable, so we take a substring and assign it back to the
string:</p>

<pre><code>if (Pattern . matches ("^[-+].*", line)) {
    line = line . substring (1);
}
</code></pre>

<p>We can now check for the right amount of digits:</p>

<pre><code>int ll = line . length ();
if (ll % 2 == 0) {
    System . out . println ("even number of digits");
    continue;
}
if (ll &lt; 3) {
    System . out . println ("too short");
    continue;
}
</code></pre>

<p>Finally, we print the wanted digits:</p>

<pre><code>System . out . println (line . substring ((ll - 3) / 2,
                                         (ll + 3) / 2));
</code></pre>

<p>Find the <a href="https://github.com/Abigail/perlweeklychallenge-club/blob/master/challenge-135/abigail/java/ch-1.java">full program</a> on <a href="https://github.com">GitHub</a>.</p>

<hr id = 'last-line'>
<div class = 'trailer'>
<p class = 'prev'><a class = "prev" href = "">&#x261C;</a></p>
<p class = 'issue'>Please leave any comments as a
  <a href = 'https://github.com/Abigail/Abigail.github.io/issues'
     title = 'GitHub issue'>GitHub issue</a>.
<p class = 'next'><a class = "next" href = "">&#x261E;</a></p>
</div>

</body>
</html>
